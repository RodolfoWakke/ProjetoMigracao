<transformation>
  <info>
    <name>04 - PASSO 4 - SEC</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2023/02/26 09:22:54.470</created_date>
    <modified_user>-</modified_user>
    <modified_date>2024/03/19 08:43:32.201</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
    <notepad>
      <note>PASSO 4: Passar os registros da mig para a tabela final no RDS.
</note>
      <xloc>16</xloc>
      <yloc>16</yloc>
      <width>511</width>
      <heigth>59</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>SECRETARIA</note>
      <xloc>144</xloc>
      <yloc>112</yloc>
      <width>117</width>
      <heigth>34</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>Y</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>255</fontcolorred>
      <fontcolorgreen>255</fontcolorgreen>
      <fontcolorblue>255</fontcolorblue>
      <backgroundcolorred>0</backgroundcolorred>
      <backgroundcolorgreen>128</backgroundcolorgreen>
      <backgroundcolorblue>255</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <connection>
    <name>RDS</name>
    <server>escolawebrds${v_end-RDS}.cdq77divwtia.sa-east-1.rds.amazonaws.com</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${v_nomebanco-RDS}</database>
    <port>3306</port>
    <username>ricardo.gad</username>
    <password>Encrypted 2be98afc86aa7f2e49910ad47df99a4df</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.autoReconnect</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.collation_connection</code>
        <attribute>utf8mb4_0900_ai_ci</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.net-read-timeout</code>
        <attribute>2800</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.net_write_timeout</code>
        <attribute>2800</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCompression</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
  </order>
  <step>
    <name>SCRIPT SECRETARIA</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>RDS</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>DROP TRIGGER IF EXISTS TAU_LOGIN;
DROP TRIGGER IF EXISTS TAU_RESPONSAVEL;

DELETE FROM login;
DELETE FROM matriculanotas;
DELETE FROM notas;
DELETE FROM avaliacao;
DELETE FROM acumuladoagrupado;
DELETE FROM acumulado;
DELETE FROM historicoct;
DELETE FROM chamadaaula;
DELETE FROM aula;
DELETE FROM professorturma;
DELETE FROM liquidacaoboleto;
DELETE FROM contasreceber;
DELETE FROM atendimento;
DELETE FROM cobrancamatricula;
DELETE FROM solicitacaovisto;
DELETE FROM logsolicitacao;
DELETE FROM solicitacao;
DELETE FROM matricula;
DELETE FROM turmadiario;
DELETE FROM etapaturma;
DELETE FROM comunicadoturma;
DELETE FROM configturma;
DELETE FROM turma;
DELETE FROM disciplina;
DELETE FROM cursosunidade;
DELETE FROM organizacaoseriecurso;
DELETE FROM seriecurso;
DELETE FROM curso;
DELETE FROM responsavel;
DELETE FROM funcionariodisponibilidade;
DELETE FROM documentofuncionario;
DELETE FROM cursofuncionario;
DELETE FROM bi_acervoemprestimo;
DELETE FROM funcionariounidade;
DELETE FROM funcionario;
DELETE FROM alunodisciplina;
DELETE FROM bolsa_aluno;
DELETE FROM retiraaluno;
DELETE FROM aluno;
DELETE FROM itenscaixa;
DELETE FROM caixa;
DELETE FROM liquidestornadas;
DELETE FROM contasreceberexcluida;
DELETE FROM usuarioconta;
DELETE FROM pagamentoforma;
DELETE FROM liquidacaoboleto;
DELETE FROM pagamento;
DELETE FROM contasreceber;
DELETE FROM contrato;
DELETE FROM conta;
DELETE FROM centroreceita;
DELETE FROM fatura;
DELETE FROM faturalote;

ALTER TABLE fatura  AUTO_INCREMENT = 1;
ALTER TABLE faturalote AUTO_INCREMENT = 1;
ALTER TABLE centroreceita AUTO_INCREMENT = 1;
ALTER TABLE contasreceber AUTO_INCREMENT = 1;
ALTER TABLE liquidacaoboleto AUTO_INCREMENT = 1;
ALTER TABLE pagamento AUTO_INCREMENT = 1;
ALTER TABLE contasreceber AUTO_INCREMENT = 1;
ALTER TABLE centroreceita AUTO_INCREMENT = 1;
ALTER TABLE contrato AUTO_INCREMENT = 1;
ALTER TABLE login AUTO_INCREMENT = 1;
ALTER TABLE matriculanotas AUTO_INCREMENT = 1;
ALTER TABLE notas AUTO_INCREMENT = 1;
ALTER TABLE avaliacao AUTO_INCREMENT = 1;
ALTER TABLE acumuladoagrupado AUTO_INCREMENT = 1;
ALTER TABLE acumulado AUTO_INCREMENT = 1;
ALTER TABLE historicoct AUTO_INCREMENT = 1;
ALTER TABLE chamadaaula AUTO_INCREMENT = 1;
ALTER TABLE aula AUTO_INCREMENT = 1;
ALTER TABLE professorturma AUTO_INCREMENT = 1;
ALTER TABLE liquidacaoboleto AUTO_INCREMENT = 1;
ALTER TABLE contasreceber AUTO_INCREMENT = 1;
ALTER TABLE atendimento AUTO_INCREMENT = 1;
ALTER TABLE cobrancamatricula AUTO_INCREMENT = 1;
ALTER TABLE solicitacaovisto AUTO_INCREMENT = 1;
ALTER TABLE logsolicitacao AUTO_INCREMENT = 1;
ALTER TABLE solicitacao AUTO_INCREMENT = 1;
ALTER TABLE matricula AUTO_INCREMENT = 1;
ALTER TABLE turmadiario AUTO_INCREMENT = 1;
ALTER TABLE etapaturma AUTO_INCREMENT = 1;
ALTER TABLE comunicadoturma AUTO_INCREMENT = 1;
ALTER TABLE configturma AUTO_INCREMENT = 1;
ALTER TABLE turma AUTO_INCREMENT = 1;
ALTER TABLE disciplina AUTO_INCREMENT = 1;
ALTER TABLE cursosunidade AUTO_INCREMENT = 1;
ALTER TABLE organizacaoseriecurso AUTO_INCREMENT = 1;
ALTER TABLE seriecurso AUTO_INCREMENT = 1;
ALTER TABLE curso AUTO_INCREMENT = 1;
ALTER TABLE responsavel AUTO_INCREMENT = 1;
ALTER TABLE funcionariodisponibilidade AUTO_INCREMENT = 1;
ALTER TABLE documentofuncionario AUTO_INCREMENT = 1;
ALTER TABLE cursofuncionario AUTO_INCREMENT = 1;
ALTER TABLE bi_acervoemprestimo AUTO_INCREMENT = 1;
ALTER TABLE funcionariounidade AUTO_INCREMENT = 1;
ALTER TABLE funcionario AUTO_INCREMENT = 1;
ALTER TABLE alunodisciplina AUTO_INCREMENT = 1;
ALTER TABLE bolsa_aluno AUTO_INCREMENT = 1;
ALTER TABLE retiraaluno AUTO_INCREMENT = 1;
ALTER TABLE aluno AUTO_INCREMENT = 1;


-- FUNCIONARIO

INSERT INTO funcionario
(funcodigo, CODESCOLARIDADE, CODBANCO, funbancoagencia, funbancoconta, funbancooperacao, CODUF, NOME, FOTO, SEXO, DTNASCIMENTO, NATURALIDADE, ESTADOCIVIL, CONJUGE, DEPENDENTES, ESCOLARIDADE, ENDERECO, COMPLEMENTO, BAIRRO, CIDADE, CEP, FONERESID, CELULAR, FONRECADO, EMAIL, RG, CPF, CATRABALHO, SERIECTRABALHO, HABILITACAO, CATEGORIA, DTADMISSAO, DTDESLIGAMENTO, MOTIVO, OBSERVACOES, ATIVO, CARTASSINADA, CAPACETE, TITELEITOR, TITZONA, HORAENTRADA, HORASAIDA, DESCANSO, FGTSOPTANTE, FGTSDTOPCAO, FGTSDTRETRATACAO, NACIONALIDADE, PAI, MAE, NUNCTMILIT, SERIECTMILIT, CATEGCTMILIT, PISDTCADASTRO, PISNUMERO, PISENDERECOBANCO, PISCODBANCO, PISCODAGENCIA, PISOBS, DTENTRADA, LIVREGISTRO, RESERVA, CODCARGO, PISBANCO, FGTSBANCO, FOTOPORTAL, LOGIN, SENHA, EMAILPORTAL, FONEPORTAL, bloqueado, UF, horariobloqueio, ipbloqueio, loginbloqueio, localbloqueio, SENHAADM, fotoblob, cor, codpaisorigem, codinep, codcidadenaturalidade, zonaresidencia4006, regimecontratacao, numcartao, alcunha, rf, qpe, avatoken, tokenfirebase, chat_ativo, idgoogledrive, wakkeuserid) 
(SELECT funcodigo, CODESCOLARIDADE, CODBANCO, funbancoagencia, funbancoconta, funbancooperacao, CODUF, NOME, FOTO, SEXO, DTNASCIMENTO, NATURALIDADE, ESTADOCIVIL, CONJUGE, DEPENDENTES, ESCOLARIDADE, ENDERECO, COMPLEMENTO, BAIRRO, CIDADE, CEP, FONERESID, CELULAR, FONRECADO, EMAIL, RG, CPF, CATRABALHO, SERIECTRABALHO, HABILITACAO, CATEGORIA, DTADMISSAO, DTDESLIGAMENTO, MOTIVO, OBSERVACOES, ATIVO, CARTASSINADA, CAPACETE, TITELEITOR, TITZONA, HORAENTRADA, HORASAIDA, DESCANSO, FGTSOPTANTE, FGTSDTOPCAO, FGTSDTRETRATACAO, NACIONALIDADE, PAI, MAE, NUNCTMILIT, SERIECTMILIT, CATEGCTMILIT, PISDTCADASTRO, PISNUMERO, PISENDERECOBANCO, PISCODBANCO, PISCODAGENCIA, PISOBS, DTENTRADA, LIVREGISTRO, RESERVA, CODCARGO, PISBANCO, FGTSBANCO, FOTOPORTAL, LOGIN, SENHA, EMAILPORTAL, FONEPORTAL, bloqueado, UF, horariobloqueio, ipbloqueio, loginbloqueio, localbloqueio, SENHAADM, fotoblob, cor, codpaisorigem, codinep, codcidadenaturalidade, zonaresidencia4006, regimecontratacao, numcartao, alcunha, rf, qpe, avatoken, tokenfirebase, chat_ativo, idgoogledrive, wakkeuserid
FROM mig_funcionario);

-- FUNCIONARIO UNIDADE

INSERT INTO funcionariounidade ( codfuncionario, codunidade)
(SELECT 
f.FUNCODIGO AS codfuncionario,
1 AS codunidade
FROM funcionario f);

-- ALUNO

INSERT INTO aluno (codaluno, nomealuno, endereco, bairro, uf, cidade, cep, telresid, celular, email, sexo, dtnascimento, ufnaturalidade, cidadenaturalidade, cor, pai, trabpai, profpai, telpai, celularpai, emailpai, mae, trabmae, profmae, telmae, celularmae, emailmae, obs, cpf, rg, foto, senha, nomeabrev, certidaonumero, certidaolivrofolha, certidaocartorio, religiao, codeducacaoespecial, obseducacaoespecial, codsocio, vivopai, instrucaopai, enderecopai, bairropai, codcidadepai, codufpai, ceppai, vivomae, instrucaomae, enderecomae, bairromae, cepmae, codufmae, codcidademae, ativo, fotoPortal, foneportal, emailportal, titeleitor, zona, dtcadastro, usercadastro, dtalteracao, useralteracao, nacionalidade, bloqueado, obshistfundamental, obshistmedio, estadocivilpai, estadocivilmae, dtnascimentopai, dtnascimentomae, codpaisnaturalidade, alunoadotado, sabeadocao, paisseparados, tiposanguineo, planosaude, alergia, doencacongenita, deficiencia, cuidadoespecial, locomocaoida, locomocaovolta, obsguiatransferencia, naturalidade, cpfpai, rgpai, cpfmae, rgmae, fotoblob, estadocivil, saisozinho, tipocertidao, certreservista, profissao, localtrabalho, teltrabalho, numcartao, enviarsms, celularsms, operadorasms, hospital, pne, pnedescricao, pneavaliado, alunofalecido, codcenso, codportaria, codpaisorigem, zonaresidencia7024, rgorgaoemissor, rgestado, rgdataemissao, rgcomplemento, modelocertidao, codcartoriocertidao, dtemissaocertidao, rgorgaoemissorpai, rgestadopai, rgdataemissaopai, nacionalidadepai, codpaisorigempai, codcidadenaturalidadepai, codescolaridadepai, rgorgaoemissormae, rgestadomae, rgdataemissaomae, nacionalidademae, codpaisorigemmae, codcidadenaturalidademae, codescolaridademae, codrendafamiliar, obsfinanceiro, obsacademico, sexomae, sexopai, codbolsapadrao, diavencpadrao, ra, localbatalhaomilitar, categoriamilitar, situacaomilitar, dataexpedicaomilitar, secaoeleitor, dataexpedicaoeleitor, avatoken, avauserid, obshistinfantil, idgoogledrive, codescolaridadealuno)
(SELECT 
MAX(codaluno) AS codaluno, 
UPPER(nomealuno) AS nomealuno, 
UPPER(endereco) AS endereco, 
UPPER(bairro) AS bairro, 
uf,
cidade,
left(REMOVEcaractere(cep),8) AS cep,
if(length(REMOVEcaractere(telresid)) IN (8,10),REMOVEcaractere(telresid),if(length(REMOVEcaractere(celular)) IN (8,10),REMOVEcaractere(celular),NULL) ) AS telresid, 
if(length(REMOVEcaractere(celular)) IN (9,11),REMOVEcaractere(celular),if(length(REMOVEcaractere(telresid)) IN (9,11),REMOVEcaractere(telresid),NULL)) AS celular, 
if(validaemail(email) COLLATE UTF8MB4_GENERAL_CI = 'V', email, NULL) AS email,
UPPER(sexo) AS sexo,
dtnascimento,
ufnaturalidade,
cidadenaturalidade,
UPPER(cor) AS cor,
UPPER(pai) AS pai,
UPPER(trabpai) AS trabpai,
left(UPPER(profpai),40) AS profpai,
if(length(REMOVEcaractere(telpai)) IN (8,10),REMOVEcaractere(telpai),if(length(REMOVEcaractere(celularpai)) IN (8,10),REMOVEcaractere(celularpai),NULL) ) AS telpai, 
if(length(REMOVEcaractere(celularpai)) IN (9,11),REMOVEcaractere(celularpai),if(length(REMOVEcaractere(telpai)) IN (9,11),REMOVEcaractere(telpai),NULL)) AS celularpai,
if(validaemail(emailpai) COLLATE utf8mb4_general_ci = 'V', emailpai, NULL) AS emailpai,
UPPER(mae) AS mae,
UPPER(trabmae) AS trabmae,
UPPER(profmae) AS profmae,
if(length(REMOVEcaractere(telmae)) IN (8,10),REMOVEcaractere(telmae),if(length(REMOVEcaractere(celularmae)) IN (8,10),REMOVEcaractere(celularmae),NULL) ) AS telmae, 
if(length(REMOVEcaractere(celularmae)) IN (9,11),REMOVEcaractere(celularmae),if(length(REMOVEcaractere(telmae)) IN (9,11),REMOVEcaractere(telmae),NULL)) AS celularmae,
if(validaemail(emailmae) COLLATE utf8mb4_general_ci = 'V', emailmae, NULL) AS emailmae,
TRIM(UPPER(CONCAT(ifnull(obs,''),' TELEFONES DO ALUNO: ',ifnull(celular,''),' | ',IFNULL(telresid,''),' / TELEFONES DO PAI ',IFNULL(celularpai,''),' | ', IFNULL(telpai,''),' / TELEFONES DA MÃE ',IFNULL(celularmae,''),' | ', IFNULL(telmae,''),' / ORGÃO EMISSOR DO RG DO ALUNO: ',IFNULL(rgorgaoemissor,''),' / ORGÃO EMISSOR DO RG DO PAI: ',IFNULL(rgorgaoemissorpai,''),' / ORGÃO EMISSOR DO RG DA MÃE: ',IFNULL(rgorgaoemissormae,''),' / EMAIL ALUNO: ',IFNULL(email,''),' / EMAIL ´PAI: ',IFNULL(emailpai,''),' / EMAIL MAE: ',IFNULL(emailmae,'')))) AS obs,
lpad(REMOVEcaractere(cpf),11,'0') AS cpf,
if(LENGTH(a.rgorgaoemissor) &lt;=5 , CONCAT(ifnull(a.rg,''),'/',ifnull(a.rgorgaoemissor,'')), a.rg ) AS rg,
foto, 
senha, 
UPPER(nomeabrev) AS nomeabrev, 
certidaonumero, 
certidaolivrofolha, 
certidaocartorio, 
UPPER(religiao) AS religiao, 
codeducacaoespecial,
obseducacaoespecial, 
codsocio,
vivopai,
instrucaopai,
UPPER(enderecopai) AS enderecopai,
UPPER(bairropai) AS bairropai,
codcidadepai, 
codufpai, 
left(REMOVEcaractere(ceppai),8) AS ceppai,
vivomae, 
UPPER(instrucaomae) AS instrucaomae, 
UPPER(enderecomae) AS enderecomae, 
UPPER(bairromae) AS bairromae, 
left(REMOVEcaractere(cepmae),8) AS cepmae,
codufmae, 
codcidademae, 
UPPER(ativo) AS ativo, 
fotoPortal, 
foneportal, 
emailportal, 
titeleitor, 
zona, 
dtcadastro, 
usercadastro, 
dtalteracao, 
useralteracao, 
UPPER(nacionalidade) AS nacionalidade, 
bloqueado, 
UPPER(obshistfundamental) AS obshistfundamental, 
UPPER(obshistmedio) AS obshistmedio, 
UPPER(estadocivilpai) AS estadocivilpai, 
UPPER(estadocivilmae) AS estadocivilmae, 
dtnascimentopai, 
dtnascimentomae, 
codpaisnaturalidade, 
alunoadotado, 
sabeadocao, 
paisseparados, 
tiposanguineo, 
planosaude, 
alergia, 
doencacongenita, 
deficiencia, 
cuidadoespecial, 
locomocaoida, 
locomocaovolta, 
obsguiatransferencia, 
UPPER(naturalidade) AS naturalidade, 
lpad(REMOVEcaractere(cpfpai),11,'0') AS cpfpai, 
if(LENGTH(a.rgorgaoemissorpai) &lt;=5 , CONCAT(ifnull(a.rgpai,''),'/',ifnull(a.rgorgaoemissorpai,'')), a.rgpai ) AS rgpai,
lpad(REMOVEcaractere(cpfmae),11,'0') AS cpfmae, 
if(LENGTH(a.rgorgaoemissormae) &lt;=5 , CONCAT(ifnull(a.rgmae,''),'/',ifnull(a.rgorgaoemissormae,'')), a.rgmae ) AS rgmae,
fotoblob, 
UPPER(estadocivil) AS estadocivil, 
saisozinho, 
tipocertidao, 
certreservista, 
UPPER(profissao) AS profissao, 
UPPER(localtrabalho) AS localtrabalho, 
teltrabalho, 
numcartao, 
enviarsms, 
celularsms, 
operadorasms, 
hospital, 
pne, 
pnedescricao, 
pneavaliado, 
alunofalecido, 
codcenso, 
codportaria, 
codpaisorigem, 
zonaresidencia7024, 
NULL AS rgorgaoemissor, 
rgestado, 
rgdataemissao, 
rgcomplemento, 
modelocertidao, 
codcartoriocertidao, 
dtemissaocertidao, 
NULL AS rgorgaoemissorpai, 
rgestadopai, 
rgdataemissaopai, 
upper(nacionalidadepai) AS nacionalidadepai, 
codpaisorigempai, 
codcidadenaturalidadepai, 
codescolaridadepai, 
NULL AS rgorgaoemissormae,
rgestadomae, 
rgdataemissaomae, 
UPPER(nacionalidademae) AS nacionalidade, 
codpaisorigemmae, 
codcidadenaturalidademae,
codescolaridademae,
codrendafamiliar,
UPPER(obsfinanceiro) AS obsfinanceiro,
UPPER(obsacademico) AS obsacademico,
sexomae,
sexopai,
codbolsapadrao,
diavencpadrao,
ra,
localbatalhaomilitar,
categoriamilitar,
situacaomilitar,
dataexpedicaomilitar,
secaoeleitor,
dataexpedicaoeleitor,
avatoken,
avauserid,
UPPER(obshistinfantil) AS obshistinfantil,
idgoogledrive,
codescolaridadealuno
FROM mig_aluno a
GROUP BY a.nomealuno);


update mig_aluno a
join aluno aa on (aa.nomealuno = a.nomealuno)
set a.codaluno_unificado = aa.codaluno ;


-- RESPONSÁVEL 

DELETE r FROM  mig_responsavel r
WHERE r.cpf = '00000000000';

INSERT INTO `responsavel` (`codsoc`, `cpf`, `nomeresponsavel`, `profissao`, `localtrabalho`, `teltrabalho`, `telresid`, `celular`, `email`, `rg`, `endereco`, `bairro`, `cidade`, `uf`, `cep`, `rendaliquida`, `sexo`, `estadocivil`, `dtnascimento`, `escolaridade`, `pai`, `mae`, `enderecocom`, `bairrocom`, `cepcom`, `codcidadecom`, `cargo`, `senha`, `login`, `fotoportal`, `nacionalidade`, `naturalidade`, `obs`, `rgorgaoemissor`, `rgestado`, `rgdataemissao`, `codpaisorigem`, `codcidadenaturalidade`, `codescolaridade`, `codfatura`, `agrupamentofatura`, `placa`, `veiculo`, `fotoblob`, `dtcadastro`, `dtalteracao`, `cadastradopor`, `alteradopor`, `codbanco`, `agencia`, `conta`, `debitoautomaticoativo`, `clienteiugu`, `inscricaoestadual`, `tokenfirebase`, `inscricaomunicipal`) VALUES (1, '00000000000', 'INEXISTENTE', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '0', '00000000000', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'R', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 'N', NULL, NULL, NULL, NULL);

INSERT INTO responsavel
(cpf, nomeresponsavel, profissao, localtrabalho, teltrabalho, telresid, celular, email, rg, endereco, bairro, cidade, uf, cep, rendaliquida, sexo, estadocivil, dtnascimento, escolaridade, pai, mae, enderecocom, bairrocom, cepcom, codcidadecom, cargo, senha, login, fotoportal, nacionalidade, naturalidade, obs, rgorgaoemissor, rgestado, rgdataemissao, codpaisorigem, codcidadenaturalidade, codescolaridade, codfatura, agrupamentofatura, placa, veiculo, fotoblob, dtcadastro, dtalteracao, cadastradopor, alteradopor, codbanco, agencia, conta, debitoautomaticoativo, clienteiugu, inscricaoestadual, tokenfirebase, inscricaomunicipal) 
(SELECT cpf, nomeresponsavel, profissao, localtrabalho, teltrabalho, telresid, celular, email, rg, endereco, bairro, cidade, uf, cep, rendaliquida, sexo, estadocivil, dtnascimento, escolaridade, pai, mae, enderecocom, bairrocom, cepcom, codcidadecom, cargo, senha, login, fotoportal, nacionalidade, naturalidade, obs, rgorgaoemissor, rgestado, rgdataemissao, codpaisorigem, codcidadenaturalidade, codescolaridade, codfatura, agrupamentofatura, placa, veiculo, fotoblob, dtcadastro, dtalteracao, cadastradopor, alteradopor, codbanco, agencia, conta, debitoautomaticoativo, clienteiugu, inscricaoestadual, tokenfirebase, inscricaomunicipal
FROM mig_responsavel r WHERE r.cpf IS NOT NULL AND r.cpf &lt;&gt; '' AND r.cpf &lt;&gt; ' '
GROUP BY r.cpf);


-- CURSO

INSERT INTO curso
(codcurso, codnivel, dsccurso, ativo, dscabreviada, enderecoaditivo, financeiroporcurso, cnae, acessaportal, dsccompleta, resolucao, cargahoraria, perfil, competencia, codcenso, codservicoprefeitura, fundamentolegal, eixotecnologico, recetapas, recsemestre, numcasasdecimais, arredfinal, calculorec, numetapas, anularesultadofinal, tipoarredetapa, suplementaretapa, profgerenciaravaliacao, mediafinaldiv, limitarrecmedia, limitarecfinalmedia, totalaprovacao, tipoagrupmateriacomposta, mediasemestreagrupado, avaliacaogrupo, calculomediafinal, qtdmateriarpp, calculomedia, anoletivosemestre, mediasemestre1, mediasemestre2, matriculaonline, rpp, formulamediaetapa, calculorecsemestre, totalaprovacaoposrecfinal, totalaprovacaoposrecfinal2, analisafaltaspordisciplina, aulahistorico, suplementarposrec, utilizanotatransferencia, setasituacaoalunoaolancarnota, periodorecuperacao, modalidade2036, codcursoprofissional2038, codboletimportal, aliquota, aliquotanfse, dscnfse, codservico, codtributacaomunicipio, liberarsituacaoaluno, concluirmatriculasemfinanceiro, financeiroporha, codcursoreplicadode, dtreplicado, replicadopor, dtcadastro, cadastradopor, servicolc116, classe, codigoemec, nomehabilitacao, modalidade, tituloconferido, grauconferido) 
(SELECT codcurso, codnivel, dsccurso, ativo, dscabreviada, enderecoaditivo, financeiroporcurso, cnae, acessaportal, dsccompleta, resolucao, cargahoraria, perfil, competencia, codcenso, codservicoprefeitura, fundamentolegal, eixotecnologico, recetapas, recsemestre, numcasasdecimais, arredfinal, calculorec, numetapas, anularesultadofinal, tipoarredetapa, suplementaretapa, profgerenciaravaliacao, mediafinaldiv, limitarrecmedia, limitarecfinalmedia, totalaprovacao, tipoagrupmateriacomposta, mediasemestreagrupado, avaliacaogrupo, calculomediafinal, qtdmateriarpp, calculomedia, anoletivosemestre, mediasemestre1, mediasemestre2, matriculaonline, rpp, formulamediaetapa, calculorecsemestre, totalaprovacaoposrecfinal, totalaprovacaoposrecfinal2, analisafaltaspordisciplina, aulahistorico, suplementarposrec, utilizanotatransferencia, setasituacaoalunoaolancarnota, periodorecuperacao, modalidade2036, codcursoprofissional2038, codboletimportal, aliquota, aliquotanfse, dscnfse, codservico, codtributacaomunicipio, liberarsituacaoaluno, concluirmatriculasemfinanceiro, financeiroporha, codcursoreplicadode, dtreplicado, replicadopor, dtcadastro, cadastradopor, servicolc116, classe, codigoemec, nomehabilitacao, modalidade, tituloconferido, grauconferido
FROM mig_curso);


-- SERIECURSO

INSERT INTO seriecurso
(codseriecurso, codcurso, codunidade, codserie, ordem, ativo, concluinte, dscserie, resolucao, incluirhistorico, dscseriecompleta, dscaprovado, dscreprovado, dscrpp, codetapaensino2037, chminima, chmaxima, qtdaulasdia, diassemana, codseriecursoreplicadode, replicadopor, dtreplicado, dtcadastro, cadastradopor) 
(SELECT codseriecurso, codcurso, codunidade, codserie, ordem, ativo, concluinte, dscserie, resolucao, incluirhistorico, dscseriecompleta, dscaprovado, dscreprovado, dscrpp, codetapaensino2037, chminima, chmaxima, qtdaulasdia, diassemana, codseriecursoreplicadode, replicadopor, dtreplicado, dtcadastro, cadastradopor
FROM mig_seriecurso s);

-- CURSOSUNIDADE PUXANDO DO SERIECURSO

INSERT INTO cursosunidade (codunidade, codcurso)
(SELECT s.codunidade, s.codcurso 
FROM seriecurso s
GROUP BY s.codunidade, s.codcurso);

-- DISCIPLINA

INSERT INTO disciplina
(coddisciplina, codarea, dscdisciplina, dscabreviada, ativo, optativa, nucleo, coddisciplinacenso, pesoreprovacao, codnucleo) 
(SELECT coddisciplina, codarea, dscdisciplina, dscabreviada, ativo, optativa, nucleo, coddisciplinacenso, pesoreprovacao, codnucleo 
FROM mig_disciplina d 
GROUP BY dscdisciplina);


update mig_disciplina d
join disciplina dd on (dd.dscdisciplina = d.dscdisciplina)
set d.coddisciplina_unificada = dd.coddisciplina ;

-- TURMA


INSERT INTO turma (codturma, dscturma, turno) 
(SELECT codturma, dscturma, turno
FROM mig_turma);

-- CONFIGTURMA

INSERT INTO configturma(codconfturma, codseriecurso, dscturma, sigla, dtinicio, dtfim, horaincio, anoletivo, turno, cadastradopor, dtcadastro, alteradopor, dtalteracao, recetapas, recsemestre, numcasasdecimais, arredfinal, calculorec, numetapas, anularesultadofinal, tipoarredetapa, suplementaretapa, rpp, profgerenciaravaliacao, mediafinaldiv, limitarrecmedia, limitarecfinalmedia, totalaprovacao, tipoagrupmateriacomposta, mediasemestreagrupado, avaliacaogrupo, codturma, numvagas, dschorario, calculomediafinal, qtdmateriarpp, calculomedia, formulamediaetapa, calculorecsemestre, aulahistorico, anoletivosemestre, mediasemestre1, mediasemestre2, matriculaonline, totalaprovacaoposrecfinal, totalaprovacaoposrecfinal2, totalpontosanoletivo, analisafaltaspordisciplina, suplementarposrec, utilizanotatransferencia, setasituacaoalunoaolancarnota, periodorecuperacao, horafinal, codinep, turmapararpp, turmaparaatividadeextra, turmaunificada8008, codcontrato, idcalendario, idconfigetapa, usuarioreplica, codconfturmaorigem, liberarsituacaoaluno, dtlimitematonline, agendainfantil, codmodeloagendainfantil, diassemana, qtdaulasdia, dtlimitmatonline, situacaomatonline, codprofassistente, codprofatendimentoespecial, concluirmatriculasemfinanceiro )
(SELECT codconfturma, codseriecurso, dscturma, sigla, dtinicio, dtfim, horaincio, anoletivo, turno, cadastradopor, dtcadastro, alteradopor, dtalteracao, recetapas, recsemestre, numcasasdecimais, arredfinal, calculorec, numetapas, anularesultadofinal, tipoarredetapa, suplementaretapa, rpp, profgerenciaravaliacao, mediafinaldiv, limitarrecmedia, limitarecfinalmedia, totalaprovacao, tipoagrupmateriacomposta, mediasemestreagrupado, avaliacaogrupo, codturma, numvagas, dschorario, calculomediafinal, qtdmateriarpp, calculomedia, formulamediaetapa, calculorecsemestre, aulahistorico, anoletivosemestre, mediasemestre1, mediasemestre2, matriculaonline, totalaprovacaoposrecfinal, totalaprovacaoposrecfinal2, totalpontosanoletivo, analisafaltaspordisciplina, suplementarposrec, utilizanotatransferencia, setasituacaoalunoaolancarnota, periodorecuperacao, horafinal, codinep, turmapararpp, turmaparaatividadeextra, turmaunificada8008, codcontrato, idcalendario, idconfigetapa, usuarioreplica, codconfturmaorigem, liberarsituacaoaluno, dtlimitematonline, agendainfantil, codmodeloagendainfantil, diassemana, qtdaulasdia, dtlimitmatonline, situacaomatonline, codprofassistente, codprofatendimentoespecial, concluirmatriculasemfinanceiro 
FROM mig_configturma c);

-- MATRÍCULA

INSERT INTO matricula (codmatricula, codaluno, codseriecurso, codturma, dtmatricula, anoletivo, dtinicio, dtfim, cpfrespacademico, cpfrespfinanceiro, parentescorespacademico, parentescorespfinanceiro, rematricula, situacao, dtcadastro, cadastradopor, qtdparcela, primeirovenc, valoranuidade, codescolaorigem, dtalteracao, alteradopor, desconto, bolsista, codbolsa, alunorespacademico, alunorespfinanceiro, valordiscipadicional, dtTransferencia, motivotransf, codcurso, codunidade, situacaoaluno, rematriculamassa, codconfturma, cpfrespfinanceiro2, parentescorespfinanceiro2, financeiroporcurso, integral, tecnicococomitante, matonline, codconffatura, intercambista )
(SELECT codmatricula, a.codaluno_unificado, codseriecurso, codturma, dtmatricula, anoletivo, dtinicio, dtfim, cpfrespacademico, cpfrespfinanceiro, parentescorespacademico, parentescorespfinanceiro, rematricula, situacao, m.dtcadastro, m.cadastradopor, qtdparcela, primeirovenc, valoranuidade, codescolaorigem, m.dtalteracao, m.alteradopor, desconto, bolsista, codbolsa, alunorespacademico, alunorespfinanceiro, valordiscipadicional, dtTransferencia, motivotransf, codcurso, codunidade, situacaoaluno, rematriculamassa, codconfturma, cpfrespfinanceiro2, parentescorespfinanceiro2, financeiroporcurso, integral, tecnicococomitante, matonline, codconffatura, intercambista 
FROM mig_matricula m 
JOIN mig_aluno a ON(a.codaluno = m.codaluno)
WHERE m.codaluno IN (SELECT codaluno FROM mig_aluno));

-- UPDATE CODESCOLA

UPDATE unidadeescolar u
SET u.codtabescola = u.codunidade;

UPDATE matricula m 
JOIN unidadeescolar u ON (m.codunidade = u.codunidade)
SET m.codescolaorigem = u.codtabescola 
WHERE m.codescolaorigem IS NULL;

-- GERAR LOGIN E SENHA NAS TABELAS DE CADASTRO

UPDATE aluno SET senha = gerasenha(6);
UPDATE responsavel SET senha = gerasenha(6);
UPDATE funcionario SET senha = gerasenha(6);

-- INSERE OS ALUNOS E SENHAS NA TABELA LOGIN

INSERT INTO login (codaluno, login2, perfil, senha) 
SELECT a.codaluno, a.codaluno, 'A', ifnull(a.senha, gerasenha(6)) AS senha 
FROM aluno a
WHERE a.codaluno NOT IN (SELECT L.codaluno as contador FROM login L where L.codaluno = a.codaluno);

-- INSERE OS RESPONSÁVEIS NA TABELA LOGIN

INSERT INTO login (login2, perfil, senha, codsoc)
SELECT r.cpf, 'R', ifnull(r.senha, gerasenha(6)) AS senha , r.codsoc
FROM responsavel r
WHERE r.codsoc NOT IN (SELECT L.codsoc as contador FROM login L where L.codsoc = r.codsoc);

-- INSERE OS FUNCIONÁRIOS NA TABELA LOGIN

INSERT INTO login (login2, perfil, senha, funcodigo)
SELECT r.LOGIN, 'P', ifnull(r.senha, gerasenha(6)) AS senha , r.funcodigo
FROM funcionario r
WHERE r.funcodigo NOT IN (SELECT L.funcodigo as contador FROM login L where L.funcodigo = r.funcodigo);

-- UPDATE EMPRESA

UPDATE login, empresa
SET login = cast(CONCAT(login.perfil,substring(empresa.codempresatella,3,4),empresa.codunidadetella,ifnull(ifnull(login.id,999),999)) as CHAR);

-- INSERIR SENHAS FALTANTES NA TABELA LOGIN

UPDATE login l 
JOIN aluno a ON a.codaluno = l.codaluno
SET l.senha = a.senha;

UPDATE login l 
JOIN responsavel r ON r.codsoc = l.codsoc
SET l.senha = r.senha;

UPDATE login l 
JOIN funcionario f ON f.FUNCODIGO = l.funcodigo
SET l.senha = f.senha;




-- VERIFICAR CPF

update aluno aa
set aa.obs = CONCAT(ifnull(aa.obs,''), ' CPF DO ALUNO: ', aa.cpf),
aa.cpf = NULL
where aa.cpf in (select tab.cpf from (select a.cpf from aluno a
where a.cpf is not null
group by a.cpf having count(1)>1) as tab);

update aluno a
set a.obs = CONCAT(ifnull(a.obs,''), ' CPF DO ALUNO: ', a.cpf),
a.cpf = NULL
where a.cpf is not null
and a.cpf = a.cpfpai;

update aluno a
set a.obs = CONCAT(ifnull(a.obs,''), ' CPF DO ALUNO: ', a.cpf),
a.cpf = NULL
where a.cpf is not null
and a.cpf = a.cpfmae;

update aluno a
set a.obs = CONCAT(ifnull(a.obs,''), ' CPF DO PAI: ', a.cpfpai),
a.cpfpai = NULL
where a.cpfpai is not null
and a.cpfpai = a.cpfmae;

-- DELETE LOGIN E SENHA DE RESP 00000000000

DELETE l FROM login l WHERE l.codsoc = 999999;

-- USUARIO TELLA ACESSANDO TODAS AS UNIDADES E TURMAS

UPDATE usuario u
SET u.unidadeacesso = (SELECT GROUP_CONCAT(un.codunidade) FROM unidadeescolar un),
	u.turmaacesso = (SELECT GROUP_CONCAT(s.codseriecurso) FROM seriecurso s)
WHERE u.nomeusuario LIKE '%tella%';</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
